@inherits LayoutComponentBase
@using ComwellWeb.Komponents
@using Core
@inject IUserService UserService

<div class="page">
    <main>
        <div class="top-row px-4 NavBarPlace">
            @if (CurrentUser?.Role == "HR")
            {
                <HRNavBar/>
            }
            else if (CurrentUser?.Role == "Student")
            {
                <StudentNavBar/>
            }
            else if (CurrentUser?.Role == "KitchenManager")
            {
                <KitchenManagerNavBar/>
            }
            else
            {
                <StdNavBar/>
            }
        </div>

        @if (CurrentUser != null)
        {
            <div class="Noti" @onclick="ToggleNotification">
                <span class="notification-icon">🔔</span>
                @if (ShowNotification)
                {
                    <div class="notification-dropdown">
                        <Notification />
                    </div>
                }
            </div>
        }

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code {
    private bool ShowNotification = false;

    private void ToggleNotification()
    {
        ShowNotification = !ShowNotification;
    }

    [Parameter]
    public User CurrentUser { get; set; } = new User();

    protected override async Task OnInitializedAsync()
    {
        CurrentUser = await UserService.GetUserLoggedInAsync() ?? new User();

    }
}
