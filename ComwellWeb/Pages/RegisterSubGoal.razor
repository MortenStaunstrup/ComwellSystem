@using ComwellWeb.Komponents.Modal
@using ComwellWeb.Services.Interfaces
@using Core;
@page "/RegisterSubGoal"
@inject ISubGoalService SubGoalService


    @if (_offeredSubGoals == null)
    {
        <p>Fetching subgoals</p>
    }
    else
    {
        <ul>
            
            @foreach (var subgoal in _offeredSubGoals)
            {
                <li style="background-color: white;" @onclick="() => OpenModal(subgoal)">
                    <span><b>Delmål Navn: </b></span>@subgoal.SubGoalName
                    <span><b>Delmål Beskrivelse: </b></span>@subgoal.SubGoalDescription
                    <span><b>Delmål Kategori: </b></span>@subgoal.SubGoalCategory
                </li>
            }
        </ul>
    }

<SubGoalDescriptionModal Goal="SelectedSubGoal" Visible="ShowModal" OnCloseRequested="CloseModal" VejenDerTil="VejenDerTil"/>
@code {
    private List<SubGoal> _offeredSubGoals; 
    /*new()
{
    new SubGoal
    { //en masse test data 
        SubGoalId = 1,
        
        SubGoalName = "Udskæring af Gris",
        SubGoalDescription = "Hej Markus, du skal i fremtiden i køkkenet lære at udskære et eller andet i en gris. Her er et link til en video der viser det: link",
        SubGoalCategory = "Køkkenkompetance",
        SubGoalDueDate = new DateOnly(2025, 3, 12),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 2,
        
        SubGoalName = "Kursus: Slibning af kniv",
        SubGoalDescription = "Alle Elever bedes se denne video før kurset begynder: link",
        SubGoalCategory = "Kursus",
        SubGoalDueDate = new DateOnly(2025, 3, 25),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 3,
        
        SubGoalName = "Sikkerhed i køkkenet",
        SubGoalDescription = "Læs sikkerhedsguiden og gennemfør quizzen bagefter.",
        SubGoalCategory = "Sikkerhed",
        SubGoalDueDate = new DateOnly(2025, 4, 2),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 4,
        
        SubGoalName = "Hygiejne-test",
        SubGoalDescription = "Aflever et hygiejnecertifikat efter færdiggørelse af online kurset.",
        SubGoalCategory = "Hygiejne",
        SubGoalDueDate = new DateOnly(2025, 4, 8),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 5,
        
        SubGoalName = "Lav en forret",
        SubGoalDescription = "Design og tilbered en simpel forret med tilhørende servering.",
        SubGoalCategory = "Madlavning",
        SubGoalDueDate = new DateOnly(2025, 4, 20),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 6,
        
        SubGoalName = "Lær råvarekendskab",
        SubGoalDescription = "Identificer og beskriv 10 råvarer, deres anvendelse og opbevaring.",
        SubGoalCategory = "Teori",
        SubGoalDueDate = new DateOnly(2025, 4, 28),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 7,
        
        SubGoalName = "Fælles madlavning",
        SubGoalDescription = "Planlæg og gennemfør en fælles madlavning med andre elever.",
        SubGoalCategory = "Gruppearbejde",
        SubGoalDueDate = new DateOnly(2025, 5, 5),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 8,
        
        SubGoalName = "Bag en kage",
        SubGoalDescription = "Vælg en opskrift, bag en kage og dokumenter processen med billeder.",
        SubGoalCategory = "Bageprojekt",
        SubGoalDueDate = new DateOnly(2025, 5, 10),
        SubGoalStatus = false
    },
    new SubGoal
    {
        SubGoalId = 9,
        
        SubGoalName = "Afslutningsevaluering",
        SubGoalDescription = "Skriv en kort evaluering af dit forløb og hvad du har lært.",
        SubGoalCategory = "Evaluering",
        SubGoalDueDate = new DateOnly(2025, 5, 15),
        SubGoalStatus = false
    }
};*/

private SubGoal? SelectedSubGoal;
private bool ShowModal = false;
public bool VejenDerTil = true;


protected override async Task OnInitializedAsync()
{
    _offeredSubGoals = await SubGoalService.GetOfferedSubGoalsAsync();
}

private void OpenModal(SubGoal goal)
{
    SelectedSubGoal = goal;
    ShowModal = true;
    VejenDerTil = true;
}

private void CloseModal()
{
    ShowModal = false;
}
}
